LavaPack.loadBundle([[904,{"../helpers/AxiosURLSearchParams":902,"../utils":922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("../utils"),s=e("../helpers/AxiosURLSearchParams");function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(e,t,r){if(!t)return e;var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i));var a,l=r&&r.encode||o,c=r&&r.serialize;return(a=c?c(t,r):n.isURLSearchParams(t)?t.toString():new s(t,r).toString(l))&&(e+=(-1===e.indexOf("?")?"?":"&")+a),e}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/buildURL.js"}],[905,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/combineURLs.js"}],[906,{"./../utils":922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./../utils");t.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,s,o,i){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(s)&&a.push("path="+s),n.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/cookies.js"}],[907,{"../utils":922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("../utils");t.exports=function(e){function t(e,r,s,o){var i=e[o++],a=Number.isFinite(+i),l=o>=e.length;return i=!i&&n.isArray(s)?s.length:i,l?(n.hasOwnProperty(s,i)?s[i]=[s[i],r]:s[i]=r,!a):(s[i]&&n.isObject(s[i])||(s[i]=[]),t(e,r,s[i],o)&&n.isArray(s[i])&&(s[i]=function(e){var t,r,n={},s=Object.keys(e),o=s.length;for(t=0;t<o;t++)n[r=s[t]]=e[r];return n}(s[i])),!a)}if(n.isFormData(e)&&n.isFunction(e.entries)){var r={};return n.forEachEntry(e,(function(e,s){t(function(e){return n.matchAll(/\w+|\[(\w*)]/g,e).map((function(e){return"[]"===e[0]?"":e[1]||e[0]}))}(e),s,r,0)})),r}return null}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/formDataToJSON.js"}],[908,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/isAbsoluteURL.js"}],[909,{"./../utils":922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./../utils");t.exports=function(e){return n.isObject(e)&&!0===e.isAxiosError}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/isAxiosError.js"}],[91,{"../../../shared/modules/string-utils":5737},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("../../../shared/modules/string-utils");r.default=class{constructor(e={}){const{preferencesController:t,addressBookController:r,accountsController:n,networkController:s,trackMetaMetricsEvent:o}=e;this.preferencesController=t,this.accountsController=n,this.addressBookController=r,this.networkController=s,this._trackMetaMetricsEvent=o}async restoreUserData(e){const t=this.preferencesController.state,{preferences:r,addressBook:n,network:s,internalAccounts:o}=JSON.parse(e);r&&(r.identities=t.identities,r.lostIdentities=t.lostIdentities,r.selectedAddress=t.selectedAddress,this.preferencesController.update(r)),n&&this.addressBookController.update(n,!0),s&&this.networkController.loadBackup(s),o&&this.accountsController.loadBackup(o),(r||n||s||o)&&this._trackMetaMetricsEvent({event:"User Data Imported",category:"Backup"})}async backupUserData(){const e={preferences:{...this.preferencesController.state},internalAccounts:{internalAccounts:this.accountsController.state.internalAccounts},addressBook:{...this.addressBookController.state},network:{networkConfigurationsByChainId:this.networkController.state.networkConfigurationsByChainId}};delete e.preferences.identities,delete e.preferences.lostIdentities,delete e.preferences.selectedAddress;const t=JSON.stringify(e),r=new Date,s=e=>(0,n.prependZero)(e,2);return{fileName:`MetaMaskUserData.${r.getFullYear()}_${s(r.getMonth()+1)}_${s(r.getDay())}_${s(r.getHours())}_${s(r.getMinutes())}_${s(r.getDay())}.json`,data:t}}}}}},{package:"$root$",file:"app/scripts/lib/backup.js"}],[910,{"./../utils":922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./../utils");t.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function s(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=s(window.location.href),function(t){var r=n.isString(t)?s(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/isURLSameOrigin.js"}],[911,{"../utils":922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("../utils");t.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/normalizeHeaderName.js"}],[912,{"./../utils":922},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("./../utils"),s=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(e){var t,r,o,i={};return e?(n.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=n.trim(e.slice(0,o)).toLowerCase(),r=n.trim(e.slice(o+1)),t){if(i[t]&&s.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([r]):i[t]?i[t]+", "+r:r}})),i):i}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/parseHeaders.js"}],[913,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/parseProtocol.js"}],[914,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=function(e){return function(t){return e.apply(null,t)}}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/spread.js"}],[915,{"../core/AxiosError":891,"../env/classes/FormData":900,"../utils":922,buffer:3941},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){(function(r){(function(){var n=e("../utils"),s=e("../core/AxiosError"),o=e("../env/classes/FormData");function i(e){return n.isPlainObject(e)||n.isArray(e)}function a(e){return n.endsWith(e,"[]")?e.slice(0,-2):e}function l(e,t,r){return e?e.concat(t).map((function(e,t){return e=a(e),!r&&t?"["+e+"]":e})).join(r?".":""):t}var c=n.toFlatObject(n,{},null,(function(e){return/^is[A-Z]/.test(e)}));t.exports=function(e,t,d){if(!n.isObject(e))throw new TypeError("target must be an object");t=t||new(o||FormData);var u,f=(d=n.toFlatObject(d,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!n.isUndefined(t[e])}))).metaTokens,p=d.visitor||_,h=d.dots,g=d.indexes,m=(d.Blob||"undefined"!=typeof Blob&&Blob)&&((u=t)&&n.isFunction(u.append)&&"FormData"===u[Symbol.toStringTag]&&u[Symbol.iterator]);if(!n.isFunction(p))throw new TypeError("visitor must be a function");function E(e){if(null===e)return"";if(n.isDate(e))return e.toISOString();if(!m&&n.isBlob(e))throw new s("Blob is not supported. Use a Buffer instead.");return n.isArrayBuffer(e)||n.isTypedArray(e)?m&&"function"==typeof Blob?new Blob([e]):r.from(e):e}function _(e,r,s){var o=e;if(e&&!s&&"object"==typeof e)if(n.endsWith(r,"{}"))r=f?r:r.slice(0,-2),e=JSON.stringify(e);else if(n.isArray(e)&&function(e){return n.isArray(e)&&!e.some(i)}(e)||n.isFileList(e)||n.endsWith(r,"[]")&&(o=n.toArray(e)))return r=a(r),o.forEach((function(e,s){!n.isUndefined(e)&&t.append(!0===g?l([r],s,h):null===g?r:r+"[]",E(e))})),!1;return!!i(e)||(t.append(l(s,r,h),E(e)),!1)}var T=[],A=Object.assign(c,{defaultVisitor:_,convertValue:E,isVisitable:i});if(!n.isObject(e))throw new TypeError("data must be an object");return function e(r,s){if(!n.isUndefined(r)){if(-1!==T.indexOf(r))throw Error("Circular reference detected in "+s.join("."));T.push(r),n.forEach(r,(function(r,o){!0===(!n.isUndefined(r)&&p.call(t,r,n.isString(o)?o.trim():o,s,A))&&e(r,s?s.concat(o):[o])})),T.pop()}}(e),t}}).call(this)}).call(this,e("buffer").Buffer)}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/toFormData.js"}],[916,{"../platform/":921,"../utils":922,"./toFormData":915},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("../utils"),s=e("./toFormData"),o=e("../platform/");t.exports=function(e,t){return s(e,new o.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,s){return o.isNode&&n.isBuffer(e)?(this.append(t,e.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},t))}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/toURLEncodedForm.js"}],[917,{"../core/AxiosError":891,"../env/data":901},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("../env/data").version,s=e("../core/AxiosError"),o={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){o[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var i={};o.transitional=function(e,t,r){function o(e,t){return"[Axios v"+n+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,a){if(!1===e)throw new s(o(n," has been removed"+(t?" in "+t:"")),s.ERR_DEPRECATED);return t&&!i[n]&&(i[n]=!0,console.warn(o(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a)}},t.exports={assertOptions:function(e,t,r){if("object"!=typeof e)throw new s("options must be an object",s.ERR_BAD_OPTION_VALUE);for(var n=Object.keys(e),o=n.length;o-- >0;){var i=n[o],a=t[i];if(a){var l=e[i],c=l===undefined||a(l,i,e);if(!0!==c)throw new s("option "+i+" must be "+c,s.ERR_BAD_OPTION_VALUE)}else if(!0!==r)throw new s("Unknown option "+i,s.ERR_BAD_OPTION)}},validators:o}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/helpers/validator.js"}],[918,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=FormData}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/platform/browser/classes/FormData.js"}],[919,{"../../../helpers/AxiosURLSearchParams":902},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=e("../../../helpers/AxiosURLSearchParams");t.exports="undefined"!=typeof URLSearchParams?URLSearchParams:n}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/platform/browser/classes/URLSearchParams.js"}],[920,{"./classes/FormData":918,"./classes/URLSearchParams":919},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports={isBrowser:!0,classes:{URLSearchParams:e("./classes/URLSearchParams"),FormData:e("./classes/FormData"),Blob:Blob},protocols:["http","https","file","blob","url","data"]}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/platform/browser/index.js"}],[921,{"./node/":920},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){t.exports=e("./node/")}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/platform/index.js"}],[922,{"./helpers/bind":903},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n,s=e("./helpers/bind"),o=Object.prototype.toString,i=(n=Object.create(null),function(e){var t=o.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())});function a(e){return e=e.toLowerCase(),function(t){return i(t)===e}}function l(e){return Array.isArray(e)}function c(e){return void 0===e}var d=a("ArrayBuffer");function u(e){return"number"==typeof e}function f(e){return null!==e&&"object"==typeof e}function p(e){if("object"!==i(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}var h=a("Date"),g=a("File"),m=a("Blob"),E=a("FileList");function _(e){return"[object Function]"===o.call(e)}var T=a("URLSearchParams");function A(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),l(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}var b,O=(b="undefined"!=typeof Uint8Array&&Object.getPrototypeOf(Uint8Array),function(e){return b&&e instanceof b});var w,v=a("HTMLFormElement"),I=(w=Object.prototype.hasOwnProperty,function(e,t){return w.call(e,t)});t.exports={isArray:l,isArrayBuffer:d,isBuffer:function(e){return null!==e&&!c(e)&&null!==e.constructor&&!c(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){var t="[object FormData]";return e&&("function"==typeof FormData&&e instanceof FormData||o.call(e)===t||_(e.toString)&&e.toString()===t)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&d(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:u,isObject:f,isPlainObject:p,isEmptyObject:function(e){return e&&0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype},isUndefined:c,isDate:h,isFile:g,isBlob:m,isFunction:_,isStream:function(e){return f(e)&&_(e.pipe)},isURLSearchParams:T,isStandardBrowserEnv:function(){var e;return("undefined"==typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:A,merge:function e(){var t={};function r(r,n){p(t[n])&&p(r)?t[n]=e(t[n],r):p(r)?t[n]=e({},r):l(r)?t[n]=r.slice():t[n]=r}for(var n=0,s=arguments.length;n<s;n++)A(arguments[n],r);return t},extend:function(e,t,r){return A(t,(function(t,n){e[n]=r&&"function"==typeof t?s(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,r,n){e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,r&&Object.assign(e.prototype,r)},toFlatObject:function(e,t,r,n){var s,o,i,a={};if(t=t||{},null==e)return t;do{for(o=(s=Object.getOwnPropertyNames(e)).length;o-- >0;)i=s[o],n&&!n(i,e,t)||a[i]||(t[i]=e[i],a[i]=!0);e=!1!==r&&Object.getPrototypeOf(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:i,kindOfTest:a,endsWith:function(e,t,r){e=String(e),(r===undefined||r>e.length)&&(r=e.length),r-=t.length;var n=e.indexOf(t,r);return-1!==n&&n===r},toArray:function(e){if(!e)return null;if(l(e))return e;var t=e.length;if(!u(t))return null;for(var r=new Array(t);t-- >0;)r[t]=e[t];return r},isTypedArray:O,isFileList:E,forEachEntry:function(e,t){for(var r,n=(e&&e[Symbol.iterator]).call(e);(r=n.next())&&!r.done;){var s=r.value;t.call(e,s[0],s[1])}},matchAll:function(e,t){for(var r,n=[];null!==(r=e.exec(t));)n.push(r);return n},isHTMLForm:v,hasOwnProperty:I}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>axios",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/axios/lib/utils.js"}],[923,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){!function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,o=Math.floor,i="[BigNumber Error] ",a=i+"Number primitive has more than 15 significant digits: ",l=1e14,c=14,d=9007199254740991,u=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],f=1e7,p=1e9;function h(e){var t=0|e;return e>0||e===t?t:t-1}function g(e){for(var t,r,n=1,s=e.length,o=e[0]+"";n<s;){for(t=e[n++]+"",r=c-t.length;r--;t="0"+t);o+=t}for(s=o.length;48===o.charCodeAt(--s););return o.slice(0,s+1||1)}function m(e,t){var r,n,s=e.c,o=t.c,i=e.s,a=t.s,l=e.e,c=t.e;if(!i||!a)return null;if(r=s&&!s[0],n=o&&!o[0],r||n)return r?n?0:-a:i;if(i!=a)return i;if(r=i<0,n=l==c,!s||!o)return n?0:!s^r?1:-1;if(!n)return l>c^r?1:-1;for(a=(l=s.length)<(c=o.length)?l:c,i=0;i<a;i++)if(s[i]!=o[i])return s[i]>o[i]^r?1:-1;return l==c?0:l>c^r?1:-1}function E(e,t,r,n){if(e<t||e>r||e!==o(e))throw Error(i+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function _(e){var t=e.c.length-1;return h(e.e/c)==t&&e.c[t]%2!=0}function T(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function A(e,t,r){var n,s;if(t<0){for(s=r+".";++t;s+=r);e=s+e}else if(++t>(n=e.length)){for(s=r,t-=n;--t;s+=r);e+=s}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}r=function e(t){var r,b,O,w,v,I,N,P,S,y,C=H.prototype={constructor:H,toString:null,valueOf:null},R=new H(1),M=20,L=4,k=-7,x=21,D=-1e7,U=1e7,F=!1,B=1,j=0,G={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},V="0123456789abcdefghijklmnopqrstuvwxyz",q=!0;function H(e,t){var r,s,i,l,u,f,p,h,g=this;if(!(g instanceof H))return new H(e,t);if(null==t){if(e&&!0===e._isBigNumber)return g.s=e.s,void(!e.c||e.e>U?g.c=g.e=null:e.e<D?g.c=[g.e=0]:(g.e=e.e,g.c=e.c.slice()));if((f="number"==typeof e)&&0*e==0){if(g.s=1/e<0?(e=-e,-1):1,e===~~e){for(l=0,u=e;u>=10;u/=10,l++);return void(l>U?g.c=g.e=null:(g.e=l,g.c=[e]))}h=String(e)}else{if(!n.test(h=String(e)))return O(g,h,f);g.s=45==h.charCodeAt(0)?(h=h.slice(1),-1):1}(l=h.indexOf("."))>-1&&(h=h.replace(".","")),(u=h.search(/e/i))>0?(l<0&&(l=u),l+=+h.slice(u+1),h=h.substring(0,u)):l<0&&(l=h.length)}else{if(E(t,2,V.length,"Base"),10==t&&q)return X(g=new H(e),M+g.e+1,L);if(h=String(e),f="number"==typeof e){if(0*e!=0)return O(g,h,f,t);if(g.s=1/e<0?(h=h.slice(1),-1):1,H.DEBUG&&h.replace(/^0\.0*|\./,"").length>15)throw Error(a+e)}else g.s=45===h.charCodeAt(0)?(h=h.slice(1),-1):1;for(r=V.slice(0,t),l=u=0,p=h.length;u<p;u++)if(r.indexOf(s=h.charAt(u))<0){if("."==s){if(u>l){l=p;continue}}else if(!i&&(h==h.toUpperCase()&&(h=h.toLowerCase())||h==h.toLowerCase()&&(h=h.toUpperCase()))){i=!0,u=-1,l=0;continue}return O(g,String(e),f,t)}f=!1,(l=(h=b(h,t,10,g.s)).indexOf("."))>-1?h=h.replace(".",""):l=h.length}for(u=0;48===h.charCodeAt(u);u++);for(p=h.length;48===h.charCodeAt(--p););if(h=h.slice(u,++p)){if(p-=u,f&&H.DEBUG&&p>15&&(e>d||e!==o(e)))throw Error(a+g.s*e);if((l=l-u-1)>U)g.c=g.e=null;else if(l<D)g.c=[g.e=0];else{if(g.e=l,g.c=[],u=(l+1)%c,l<0&&(u+=c),u<p){for(u&&g.c.push(+h.slice(0,u)),p-=c;u<p;)g.c.push(+h.slice(u,u+=c));u=c-(h=h.slice(u)).length}else u-=p;for(;u--;h+="0");g.c.push(+h)}}else g.c=[g.e=0]}function Y(e,t,r,n){var s,o,i,a,l;if(null==r?r=L:E(r,0,8),!e.c)return e.toString();if(s=e.c[0],i=e.e,null==t)l=g(e.c),l=1==n||2==n&&(i<=k||i>=x)?T(l,i):A(l,i,"0");else if(o=(e=X(new H(e),t,r)).e,a=(l=g(e.c)).length,1==n||2==n&&(t<=o||o<=k)){for(;a<t;l+="0",a++);l=T(l,o)}else if(t-=i,l=A(l,o,"0"),o+1>a){if(--t>0)for(l+=".";t--;l+="0");}else if((t+=o-a)>0)for(o+1==a&&(l+=".");t--;l+="0");return e.s<0&&s?"-"+l:l}function $(e,t){for(var r,n,s=1,o=new H(e[0]);s<e.length;s++)(!(n=new H(e[s])).s||(r=m(o,n))===t||0===r&&o.s===t)&&(o=n);return o}function K(e,t,r){for(var n=1,s=t.length;!t[--s];t.pop());for(s=t[0];s>=10;s/=10,n++);return(r=n+r*c-1)>U?e.c=e.e=null:r<D?e.c=[e.e=0]:(e.e=r,e.c=t),e}function X(e,t,r,n){var i,a,d,f,p,h,g,m=e.c,E=u;if(m){e:{for(i=1,f=m[0];f>=10;f/=10,i++);if((a=t-i)<0)a+=c,d=t,p=m[h=0],g=o(p/E[i-d-1]%10);else if((h=s((a+1)/c))>=m.length){if(!n)break e;for(;m.length<=h;m.push(0));p=g=0,i=1,d=(a%=c)-c+1}else{for(p=f=m[h],i=1;f>=10;f/=10,i++);g=(d=(a%=c)-c+i)<0?0:o(p/E[i-d-1]%10)}if(n=n||t<0||null!=m[h+1]||(d<0?p:p%E[i-d-1]),n=r<4?(g||n)&&(0==r||r==(e.s<0?3:2)):g>5||5==g&&(4==r||n||6==r&&(a>0?d>0?p/E[i-d]:0:m[h-1])%10&1||r==(e.s<0?8:7)),t<1||!m[0])return m.length=0,n?(t-=e.e+1,m[0]=E[(c-t%c)%c],e.e=-t||0):m[0]=e.e=0,e;if(0==a?(m.length=h,f=1,h--):(m.length=h+1,f=E[c-a],m[h]=d>0?o(p/E[i-d]%E[d])*f:0),n)for(;;){if(0==h){for(a=1,d=m[0];d>=10;d/=10,a++);for(d=m[0]+=f,f=1;d>=10;d/=10,f++);a!=f&&(e.e++,m[0]==l&&(m[0]=1));break}if(m[h]+=f,m[h]!=l)break;m[h--]=0,f=1}for(a=m.length;0===m[--a];m.pop());}e.e>U?e.c=e.e=null:e.e<D&&(e.c=[e.e=0])}return e}function z(e){var t,r=e.e;return null===r?e.toString():(t=g(e.c),t=r<=k||r>=x?T(t,r):A(t,r,"0"),e.s<0?"-"+t:t)}return H.clone=e,H.ROUND_UP=0,H.ROUND_DOWN=1,H.ROUND_CEIL=2,H.ROUND_FLOOR=3,H.ROUND_HALF_UP=4,H.ROUND_HALF_DOWN=5,H.ROUND_HALF_EVEN=6,H.ROUND_HALF_CEIL=7,H.ROUND_HALF_FLOOR=8,H.EUCLID=9,H.config=H.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(i+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(E(r=e[t],0,p,t),M=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(E(r=e[t],0,8,t),L=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(E(r[0],-p,0,t),E(r[1],0,p,t),k=r[0],x=r[1]):(E(r,-p,p,t),k=-(x=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)E(r[0],-p,-1,t),E(r[1],1,p,t),D=r[0],U=r[1];else{if(E(r,-p,p,t),!r)throw Error(i+t+" cannot be zero: "+r);D=-(U=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(i+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw F=!r,Error(i+"crypto unavailable");F=r}else F=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(E(r=e[t],0,9,t),B=r),e.hasOwnProperty(t="POW_PRECISION")&&(E(r=e[t],0,p,t),j=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(i+t+" not an object: "+r);G=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(i+t+" invalid: "+r);q="0123456789"==r.slice(0,10),V=r}}return{DECIMAL_PLACES:M,ROUNDING_MODE:L,EXPONENTIAL_AT:[k,x],RANGE:[D,U],CRYPTO:F,MODULO_MODE:B,POW_PRECISION:j,FORMAT:G,ALPHABET:V}},H.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!H.DEBUG)return!0;var t,r,n=e.c,s=e.e,a=e.s;e:if("[object Array]"=={}.toString.call(n)){if((1===a||-1===a)&&s>=-p&&s<=p&&s===o(s)){if(0===n[0]){if(0===s&&1===n.length)return!0;break e}if((t=(s+1)%c)<1&&(t+=c),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=l||r!==o(r))break e;if(0!==r)return!0}}}else if(null===n&&null===s&&(null===a||1===a||-1===a))return!0;throw Error(i+"Invalid BigNumber: "+e)},H.maximum=H.max=function(){return $(arguments,-1)},H.minimum=H.min=function(){return $(arguments,1)},H.random=(w=9007199254740992,v=Math.random()*w&2097151?function(){return o(Math.random()*w)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,a,l,d=0,f=[],h=new H(R);if(null==e?e=M:E(e,0,p),a=s(e/c),F)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(a*=2));d<a;)(l=131072*t[d]+(t[d+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[d]=r[0],t[d+1]=r[1]):(f.push(l%1e14),d+=2);d=a/2}else{if(!crypto.randomBytes)throw F=!1,Error(i+"crypto unavailable");for(t=crypto.randomBytes(a*=7);d<a;)(l=281474976710656*(31&t[d])+1099511627776*t[d+1]+4294967296*t[d+2]+16777216*t[d+3]+(t[d+4]<<16)+(t[d+5]<<8)+t[d+6])>=9e15?crypto.randomBytes(7).copy(t,d):(f.push(l%1e14),d+=7);d=a/7}if(!F)for(;d<a;)(l=v())<9e15&&(f[d++]=l%1e14);for(a=f[--d],e%=c,a&&e&&(l=u[c-e],f[d]=o(a/l)*l);0===f[d];f.pop(),d--);if(d<0)f=[n=0];else{for(n=-1;0===f[0];f.splice(0,1),n-=c);for(d=1,l=f[0];l>=10;l/=10,d++);d<c&&(n-=c-d)}return h.e=n,h.c=f,h}),H.sum=function(){for(var e=1,t=arguments,r=new H(t[0]);e<t.length;)r=r.plus(t[e++]);return r},b=function(){var e="0123456789";function t(e,t,r,n){for(var s,o,i=[0],a=0,l=e.length;a<l;){for(o=i.length;o--;i[o]*=t);for(i[0]+=n.indexOf(e.charAt(a++)),s=0;s<i.length;s++)i[s]>r-1&&(null==i[s+1]&&(i[s+1]=0),i[s+1]+=i[s]/r|0,i[s]%=r)}return i.reverse()}return function(n,s,o,i,a){var l,c,d,u,f,p,h,m,E=n.indexOf("."),_=M,T=L;for(E>=0&&(u=j,j=0,n=n.replace(".",""),p=(m=new H(s)).pow(n.length-E),j=u,m.c=t(A(g(p.c),p.e,"0"),10,o,e),m.e=m.c.length),d=u=(h=t(n,s,o,a?(l=V,e):(l=e,V))).length;0==h[--u];h.pop());if(!h[0])return l.charAt(0);if(E<0?--d:(p.c=h,p.e=d,p.s=i,h=(p=r(p,m,_,T,o)).c,f=p.r,d=p.e),E=h[c=d+_+1],u=o/2,f=f||c<0||null!=h[c+1],f=T<4?(null!=E||f)&&(0==T||T==(p.s<0?3:2)):E>u||E==u&&(4==T||f||6==T&&1&h[c-1]||T==(p.s<0?8:7)),c<1||!h[0])n=f?A(l.charAt(1),-_,l.charAt(0)):l.charAt(0);else{if(h.length=c,f)for(--o;++h[--c]>o;)h[c]=0,c||(++d,h=[1].concat(h));for(u=h.length;!h[--u];);for(E=0,n="";E<=u;n+=l.charAt(h[E++]));n=A(n,d,l.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,s,o,i,a=0,l=e.length,c=t%f,d=t/f|0;for(e=e.slice();l--;)a=((s=c*(o=e[l]%f)+(n=d*o+(i=e[l]/f|0)*c)%f*f+a)/r|0)+(n/f|0)+d*i,e[l]=s%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var s,o;if(r!=n)o=r>n?1:-1;else for(s=o=0;s<r;s++)if(e[s]!=t[s]){o=e[s]>t[s]?1:-1;break}return o}function r(e,t,r,n){for(var s=0;r--;)e[r]-=s,s=e[r]<t[r]?1:0,e[r]=s*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,s,i,a,d){var u,f,p,g,m,E,_,T,A,b,O,w,v,I,N,P,S,y=n.s==s.s?1:-1,C=n.c,R=s.c;if(!(C&&C[0]&&R&&R[0]))return new H(n.s&&s.s&&(C?!R||C[0]!=R[0]:R)?C&&0==C[0]||!R?0*y:y/0:NaN);for(A=(T=new H(y)).c=[],y=i+(f=n.e-s.e)+1,d||(d=l,f=h(n.e/c)-h(s.e/c),y=y/c|0),p=0;R[p]==(C[p]||0);p++);if(R[p]>(C[p]||0)&&f--,y<0)A.push(1),g=!0;else{for(I=C.length,P=R.length,p=0,y+=2,(m=o(d/(R[0]+1)))>1&&(R=e(R,m,d),C=e(C,m,d),P=R.length,I=C.length),v=P,O=(b=C.slice(0,P)).length;O<P;b[O++]=0);S=R.slice(),S=[0].concat(S),N=R[0],R[1]>=d/2&&N++;do{if(m=0,(u=t(R,b,P,O))<0){if(w=b[0],P!=O&&(w=w*d+(b[1]||0)),(m=o(w/N))>1)for(m>=d&&(m=d-1),_=(E=e(R,m,d)).length,O=b.length;1==t(E,b,_,O);)m--,r(E,P<_?S:R,_,d),_=E.length,u=1;else 0==m&&(u=m=1),_=(E=R.slice()).length;if(_<O&&(E=[0].concat(E)),r(b,E,O,d),O=b.length,-1==u)for(;t(R,b,P,O)<1;)m++,r(b,P<O?S:R,O,d),O=b.length}else 0===u&&(m++,b=[0]);A[p++]=m,b[0]?b[O++]=C[v]||0:(b=[C[v]],O=1)}while((v++<I||null!=b[0])&&y--);g=null!=b[0],A[0]||A.splice(0,1)}if(d==l){for(p=1,y=A[0];y>=10;y/=10,p++);X(T,i+(T.e=p+f*c-1)+1,a,g)}else T.e=f,T.r=+g;return T}}(),I=/^(-?)0([xbo])(?=\w[\w.]*$)/i,N=/^([^.]+)\.$/,P=/^\.([^.]+)$/,S=/^-?(Infinity|NaN)$/,y=/^\s*\+(?=[\w.])|^\s+|\s+$/g,O=function(e,t,r,n){var s,o=r?t:t.replace(y,"");if(S.test(o))e.s=isNaN(o)?null:o<0?-1:1;else{if(!r&&(o=o.replace(I,(function(e,t,r){return s="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=s?e:t})),n&&(s=n,o=o.replace(N,"$1").replace(P,"0.$1")),t!=o))return new H(o,s);if(H.DEBUG)throw Error(i+"Not a"+(n?" base "+n:"")+" number: "+t);e.s=null}e.c=e.e=null},C.absoluteValue=C.abs=function(){var e=new H(this);return e.s<0&&(e.s=1),e},C.comparedTo=function(e,t){return m(this,new H(e,t))},C.decimalPlaces=C.dp=function(e,t){var r,n,s,o=this;if(null!=e)return E(e,0,p),null==t?t=L:E(t,0,8),X(new H(o),e+o.e+1,t);if(!(r=o.c))return null;if(n=((s=r.length-1)-h(this.e/c))*c,s=r[s])for(;s%10==0;s/=10,n--);return n<0&&(n=0),n},C.dividedBy=C.div=function(e,t){return r(this,new H(e,t),M,L)},C.dividedToIntegerBy=C.idiv=function(e,t){return r(this,new H(e,t),0,1)},C.exponentiatedBy=C.pow=function(e,t){var r,n,a,l,d,u,f,p,h=this;if((e=new H(e)).c&&!e.isInteger())throw Error(i+"Exponent not an integer: "+z(e));if(null!=t&&(t=new H(t)),d=e.e>14,!h.c||!h.c[0]||1==h.c[0]&&!h.e&&1==h.c.length||!e.c||!e.c[0])return p=new H(Math.pow(+z(h),d?e.s*(2-_(e)):+z(e))),t?p.mod(t):p;if(u=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new H(NaN);(n=!u&&h.isInteger()&&t.isInteger())&&(h=h.mod(t))}else{if(e.e>9&&(h.e>0||h.e<-1||(0==h.e?h.c[0]>1||d&&h.c[1]>=24e7:h.c[0]<8e13||d&&h.c[0]<=9999975e7)))return l=h.s<0&&_(e)?-0:0,h.e>-1&&(l=1/l),new H(u?1/l:l);j&&(l=s(j/c+2))}for(d?(r=new H(.5),u&&(e.s=1),f=_(e)):f=(a=Math.abs(+z(e)))%2,p=new H(R);;){if(f){if(!(p=p.times(h)).c)break;l?p.c.length>l&&(p.c.length=l):n&&(p=p.mod(t))}if(a){if(0===(a=o(a/2)))break;f=a%2}else if(X(e=e.times(r),e.e+1,1),e.e>14)f=_(e);else{if(0===(a=+z(e)))break;f=a%2}h=h.times(h),l?h.c&&h.c.length>l&&(h.c.length=l):n&&(h=h.mod(t))}return n?p:(u&&(p=R.div(p)),t?p.mod(t):l?X(p,j,L,undefined):p)},C.integerValue=function(e){var t=new H(this);return null==e?e=L:E(e,0,8),X(t,t.e+1,e)},C.isEqualTo=C.eq=function(e,t){return 0===m(this,new H(e,t))},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(e,t){return m(this,new H(e,t))>0},C.isGreaterThanOrEqualTo=C.gte=function(e,t){return 1===(t=m(this,new H(e,t)))||0===t},C.isInteger=function(){return!!this.c&&h(this.e/c)>this.c.length-2},C.isLessThan=C.lt=function(e,t){return m(this,new H(e,t))<0},C.isLessThanOrEqualTo=C.lte=function(e,t){return-1===(t=m(this,new H(e,t)))||0===t},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return this.s>0},C.isZero=function(){return!!this.c&&0==this.c[0]},C.minus=function(e,t){var r,n,s,o,i=this,a=i.s;if(t=(e=new H(e,t)).s,!a||!t)return new H(NaN);if(a!=t)return e.s=-t,i.plus(e);var d=i.e/c,u=e.e/c,f=i.c,p=e.c;if(!d||!u){if(!f||!p)return f?(e.s=-t,e):new H(p?i:NaN);if(!f[0]||!p[0])return p[0]?(e.s=-t,e):new H(f[0]?i:3==L?-0:0)}if(d=h(d),u=h(u),f=f.slice(),a=d-u){for((o=a<0)?(a=-a,s=f):(u=d,s=p),s.reverse(),t=a;t--;s.push(0));s.reverse()}else for(n=(o=(a=f.length)<(t=p.length))?a:t,a=t=0;t<n;t++)if(f[t]!=p[t]){o=f[t]<p[t];break}if(o&&(s=f,f=p,p=s,e.s=-e.s),(t=(n=p.length)-(r=f.length))>0)for(;t--;f[r++]=0);for(t=l-1;n>a;){if(f[--n]<p[n]){for(r=n;r&&!f[--r];f[r]=t);--f[r],f[n]+=l}f[n]-=p[n]}for(;0==f[0];f.splice(0,1),--u);return f[0]?K(e,f,u):(e.s=3==L?-1:1,e.c=[e.e=0],e)},C.modulo=C.mod=function(e,t){var n,s,o=this;return e=new H(e,t),!o.c||!e.s||e.c&&!e.c[0]?new H(NaN):!e.c||o.c&&!o.c[0]?new H(o):(9==B?(s=e.s,e.s=1,n=r(o,e,0,3),e.s=s,n.s*=s):n=r(o,e,0,B),(e=o.minus(n.times(e))).c[0]||1!=B||(e.s=o.s),e)},C.multipliedBy=C.times=function(e,t){var r,n,s,o,i,a,d,u,p,g,m,E,_,T,A,b=this,O=b.c,w=(e=new H(e,t)).c;if(!(O&&w&&O[0]&&w[0]))return!b.s||!e.s||O&&!O[0]&&!w||w&&!w[0]&&!O?e.c=e.e=e.s=null:(e.s*=b.s,O&&w?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=h(b.e/c)+h(e.e/c),e.s*=b.s,(d=O.length)<(g=w.length)&&(_=O,O=w,w=_,s=d,d=g,g=s),s=d+g,_=[];s--;_.push(0));for(T=l,A=f,s=g;--s>=0;){for(r=0,m=w[s]%A,E=w[s]/A|0,o=s+(i=d);o>s;)r=((u=m*(u=O[--i]%A)+(a=E*u+(p=O[i]/A|0)*m)%A*A+_[o]+r)/T|0)+(a/A|0)+E*p,_[o--]=u%T;_[o]=r}return r?++n:_.splice(0,1),K(e,_,n)},C.negated=function(){var e=new H(this);return e.s=-e.s||null,e},C.plus=function(e,t){var r,n=this,s=n.s;if(t=(e=new H(e,t)).s,!s||!t)return new H(NaN);if(s!=t)return e.s=-t,n.minus(e);var o=n.e/c,i=e.e/c,a=n.c,d=e.c;if(!o||!i){if(!a||!d)return new H(s/0);if(!a[0]||!d[0])return d[0]?e:new H(a[0]?n:0*s)}if(o=h(o),i=h(i),a=a.slice(),s=o-i){for(s>0?(i=o,r=d):(s=-s,r=a),r.reverse();s--;r.push(0));r.reverse()}for((s=a.length)-(t=d.length)<0&&(r=d,d=a,a=r,t=s),s=0;t;)s=(a[--t]=a[t]+d[t]+s)/l|0,a[t]=l===a[t]?0:a[t]%l;return s&&(a=[s].concat(a),++i),K(e,a,i)},C.precision=C.sd=function(e,t){var r,n,s,o=this;if(null!=e&&e!==!!e)return E(e,1,p),null==t?t=L:E(t,0,8),X(new H(o),e,t);if(!(r=o.c))return null;if(n=(s=r.length-1)*c+1,s=r[s]){for(;s%10==0;s/=10,n--);for(s=r[0];s>=10;s/=10,n++);}return e&&o.e+1>n&&(n=o.e+1),n},C.shiftedBy=function(e){return E(e,-9007199254740991,d),this.times("1e"+e)},C.squareRoot=C.sqrt=function(){var e,t,n,s,o,i=this,a=i.c,l=i.s,c=i.e,d=M+4,u=new H("0.5");if(1!==l||!a||!a[0])return new H(!l||l<0&&(!a||a[0])?NaN:a?i:1/0);if(0==(l=Math.sqrt(+z(i)))||l==1/0?(((t=g(a)).length+c)%2==0&&(t+="0"),l=Math.sqrt(+t),c=h((c+1)/2)-(c<0||c%2),n=new H(t=l==1/0?"5e"+c:(t=l.toExponential()).slice(0,t.indexOf("e")+1)+c)):n=new H(l+""),n.c[0])for((l=(c=n.e)+d)<3&&(l=0);;)if(o=n,n=u.times(o.plus(r(i,o,d,1))),g(o.c).slice(0,l)===(t=g(n.c)).slice(0,l)){if(n.e<c&&--l,"9999"!=(t=t.slice(l-3,l+1))&&(s||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(X(n,n.e+M+2,1),e=!n.times(n).eq(i));break}if(!s&&(X(o,o.e+M+2,0),o.times(o).eq(i))){n=o;break}d+=4,l+=4,s=1}return X(n,n.e+M+1,L,e)},C.toExponential=function(e,t){return null!=e&&(E(e,0,p),e++),Y(this,e,t,1)},C.toFixed=function(e,t){return null!=e&&(E(e,0,p),e=e+this.e+1),Y(this,e,t)},C.toFormat=function(e,t,r){var n,s=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=G;else if("object"!=typeof r)throw Error(i+"Argument not an object: "+r);if(n=s.toFixed(e,t),s.c){var o,a=n.split("."),l=+r.groupSize,c=+r.secondaryGroupSize,d=r.groupSeparator||"",u=a[0],f=a[1],p=s.s<0,h=p?u.slice(1):u,g=h.length;if(c&&(o=l,l=c,c=o,g-=o),l>0&&g>0){for(o=g%l||l,u=h.substr(0,o);o<g;o+=l)u+=d+h.substr(o,l);c>0&&(u+=d+h.slice(o)),p&&(u="-"+u)}n=f?u+(r.decimalSeparator||"")+((c=+r.fractionGroupSize)?f.replace(new RegExp("\\d{"+c+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):f):u}return(r.prefix||"")+n+(r.suffix||"")},C.toFraction=function(e){var t,n,s,o,a,l,d,f,p,h,m,E,_=this,T=_.c;if(null!=e&&(!(d=new H(e)).isInteger()&&(d.c||1!==d.s)||d.lt(R)))throw Error(i+"Argument "+(d.isInteger()?"out of range: ":"not an integer: ")+z(d));if(!T)return new H(_);for(t=new H(R),p=n=new H(R),s=f=new H(R),E=g(T),a=t.e=E.length-_.e-1,t.c[0]=u[(l=a%c)<0?c+l:l],e=!e||d.comparedTo(t)>0?a>0?t:p:d,l=U,U=1/0,d=new H(E),f.c[0]=0;h=r(d,t,0,1),1!=(o=n.plus(h.times(s))).comparedTo(e);)n=s,s=o,p=f.plus(h.times(o=p)),f=o,t=d.minus(h.times(o=t)),d=o;return o=r(e.minus(n),s,0,1),f=f.plus(o.times(p)),n=n.plus(o.times(s)),f.s=p.s=_.s,m=r(p,s,a*=2,L).minus(_).abs().comparedTo(r(f,n,a,L).minus(_).abs())<1?[p,s]:[f,n],U=l,m},C.toNumber=function(){return+z(this)},C.toPrecision=function(e,t){return null!=e&&E(e,1,p),Y(this,e,t,2)},C.toString=function(e){var t,r=this,n=r.s,s=r.e;return null===s?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(null==e?t=s<=k||s>=x?T(g(r.c),s):A(g(r.c),s,"0"):10===e&&q?t=A(g((r=X(new H(r),M+s+1,L)).c),r.e,"0"):(E(e,2,V.length,"Base"),t=b(A(g(r.c),s,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},C.valueOf=C.toJSON=function(){return z(this)},C._isBigNumber=!0,null!=t&&H.set(t),H}(),r.default=r.BigNumber=r,"function"==typeof define&&define.amd?define((function(){return r})):void 0!==t&&t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(this)}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>bignumber.js",file:"node_modules/@ledgerhq/hw-app-eth/node_modules/bignumber.js/bignumber.js"}],[924,{rxjs:5223},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.setEnvUnsafe=r.setEnv=r.changes=r.getEnvDesc=r.isEnvDefault=r.getEnvDefault=r.getEnv=r.getAllEnvs=r.getAllEnvNames=r.getDefinition=void 0;const n=e("rxjs"),s=e=>{if(!Number.isNaN(e))return parseInt(e,10)},o=e=>{if(!Number.isNaN(e))return parseFloat(e)},i=e=>"boolean"==typeof e?e:!("0"===e||"false"===e),a=e=>"string"==typeof e?e:undefined,l=e=>{const t="string"==typeof e?e.split(","):null;if(Array.isArray(t)&&t.length>0)return t},c={ADDRESS_POISONING_FAMILIES:{def:"evm,tron",parser:a,desc:"List of families impacted by the address poisoning attack"},ANALYTICS_CONSOLE:{def:!1,parser:i,desc:"Show tracking overlays on the app UI"},DEBUG_THEME:{def:!1,parser:i,desc:"Show theme debug overlay UI"},API_ICP_ENDPOINT:{def:"https://icp.coin.ledger.com/",parser:a,desc:"Rosetta API for ICP"},API_CASPER_INDEXER_ENDPOINT:{parser:a,def:"https://casper.coin.ledger.com/indexer",desc:"Casper API url indexer"},API_CASPER_NODE_ENDPOINT:{parser:a,def:"https://casper.coin.ledger.com/node/",desc:"Casper API url node"},API_ALGORAND_BLOCKCHAIN_EXPLORER_API_ENDPOINT:{def:"https://algorand.coin.ledger.com",parser:a,desc:"Node API endpoint for algorand"},API_CELO_INDEXER:{def:"https://celo.coin.ledger.com/indexer/",parser:a,desc:"Explorer API for celo"},API_CELO_NODE:{def:"https://celo.coin.ledger.com/archive/",parser:a,desc:"Node endpoint for celo"},COSMOS_GAS_AMPLIFIER:{def:1.3,parser:s,desc:"Cosmos gas estimate multiplier"},API_FILECOIN_ENDPOINT:{parser:a,def:"https://filecoin.coin.ledger.com",desc:"Filecoin API url"},API_STACKS_ENDPOINT:{parser:a,def:"https://stacks.coin.ledger.com",desc:"Stacks API url"},API_POLKADOT_INDEXER:{parser:a,def:"https://polkadot.coin.ledger.com",desc:"Explorer API for polkadot"},API_POLKADOT_SIDECAR:{parser:a,def:"https://polkadot-sidecar.coin.ledger.com",desc:"Polkadot Sidecar API url"},API_POLKADOT_SIDECAR_CREDENTIALS:{parser:a,def:"",desc:"Polkadot Sidecar API credentials"},API_POLKADOT_NODE:{parser:a,def:"https://polkadot-fullnodes.api.live.ledger.com",desc:"Polkadot Node"},ELROND_API_ENDPOINT:{parser:a,def:"https://elrond.coin.ledger.com",desc:"Elrond API url"},ELROND_DELEGATION_API_ENDPOINT:{parser:a,def:"https://delegations-elrond.coin.ledger.com",desc:"Elrond DELEGATION API url"},API_STELLAR_HORIZON:{parser:a,def:"https://stellar.coin.ledger.com",desc:"Stellar Horizon API url"},API_STELLAR_HORIZON_FETCH_LIMIT:{parser:s,def:100,desc:"Limit of operation that Horizon will fetch per page"},API_STELLAR_HORIZON_STATIC_FEE:{def:!1,parser:i,desc:"Static fee for Stellar account"},API_TEZOS_BAKER:{parser:a,def:"https://tezos-bakers.api.live.ledger.com",desc:"bakers API for tezos"},API_TEZOS_BLOCKCHAIN_EXPLORER_API_ENDPOINT:{def:"https://xtz-explorer.api.live.ledger.com/explorer",parser:a,desc:"Ledger explorer API for tezos"},API_TEZOS_TZKT_API:{def:"https://xtz-tzkt-explorer.api.live.ledger.com",parser:a,desc:"tzkt.io explorer"},API_TEZOS_NODE:{def:"https://xtz-node.api.live.ledger.com",parser:a,desc:"node API for tezos (for broadcast only)"},API_TRONGRID_PROXY:{parser:a,def:"https://tron.coin.ledger.com",desc:"proxy url for trongrid API"},API_SOLANA_PROXY:{parser:a,def:"https://solana.coin.ledger.com",desc:"proxy url for solana API"},SOLANA_VALIDATORS_APP_BASE_URL:{parser:a,def:"https://earn.api.live.ledger.com/v0/network/solana/validator-details",desc:"base url for validators.app validator list"},SOLANA_TESTNET_VALIDATORS_APP_BASE_URL:{parser:a,def:"https://validators-solana.coin.ledger.com/api/v1/validators",desc:"base url for testnet validators.app validator list"},SOLANA_TX_CONFIRMATION_TIMEOUT:{def:1e5,parser:s,desc:"solana transaction broadcast confirmation timeout"},API_HEDERA_MIRROR:{def:"https://hedera.coin.ledger.com",parser:a,desc:"mirror node API for Hedera"},API_VECHAIN_THOREST:{def:"https://vechain.coin.ledger.com",parser:a,desc:"Thorest API for VeChain"},BASE_SOCKET_URL:{def:"wss://scriptrunner.api.live.ledger.com/update",parser:a,desc:"Ledger script runner API"},BOT_TIMEOUT_SCAN_ACCOUNTS:{def:6e5,parser:s,desc:"bot's default timeout for scanAccounts"},BOT_SPEC_DEFAULT_TIMEOUT:{def:18e5,parser:s,desc:"define the default value of spec.skipMutationsTimeout (if not overriden by spec)"},BUY_API_BASE:{def:"https://buy.api.live.ledger.com/buy/v1",parser:a,desc:"Buy crypto API base url - version 1"},CARDANO_API_ENDPOINT:{def:"https://cardano.coin.ledger.com/api",parser:a,desc:"Cardano API url"},CARDANO_TESTNET_API_ENDPOINT:{def:"https://testnet-ledger.cardanoscan.io/api",parser:a,desc:"Cardano API url"},ICON_NODE_ENDPOINT:{parser:a,def:"https://icon.coin.ledger.com/api/v3",desc:"ICON RPC url"},ICON_DEBUG_ENDPOINT:{parser:a,def:"https://icon.coin.ledger.com/api/v3d",desc:"ICON debug RPC url"},ICON_INDEXER_ENDPOINT:{parser:a,def:"https://icon.coin.ledger.com/api/v1",desc:"ICON API url"},ICON_TESTNET_NODE_ENDPOINT:{parser:a,def:"https://berlin.net.solidwallet.io/api/v3",desc:"ICON Berlin Testnet API url"},ICON_TESTNET_DEBUG_ENDPOINT:{parser:a,def:"https://berlin.net.solidwallet.io/api/v3d",desc:"ICON Berlin Testnet debug"},ICON_TESTNET_INDEXER_ENDPOINT:{parser:a,def:"https://tracker.berlin.icon.community/api/v1",desc:"ICON Berlin Testnet API url"},COINAPPS:{def:"",parser:a,desc:"(dev feature) defines the folder for speculos mode that contains Nano apps binaries (.elf) in a specific structure: <device>/<firmware>/<appName>/app_<appVersion>.elf"},CRYPTO_ORG_INDEXER:{def:"https://cryptoorg-rpc-indexer.coin.ledger.com",parser:a,desc:"location of the Cronos POS Chain (formerly Crypto.org) indexer API"},CRYPTO_ORG_TESTNET_INDEXER:{def:"https://cronos-pos.org/explorer/croeseid4",parser:a,desc:"location of the Cronos POS Chain (formerly Crypto.org) indexer testnet API"},CRYPTO_ORG_RPC_URL:{def:"https://cryptoorg-rpc-node.coin.ledger.com",parser:a,desc:"location of the Cronos POS Chain (formerly Crypto.org) chain node"},CRYPTO_ORG_TESTNET_RPC_URL:{def:"https://rpc-testnet-croeseid-4.crypto.org",parser:a,desc:"location of the Cronos POS Chain (formerly Crypto.org) chain testnet node"},DEBUG_UTXO_DISPLAY:{def:4,parser:s,desc:"define maximum number of utxos to display in CLI"},DEBUG_HTTP_RESPONSE:{def:!1,parser:i,desc:"includes HTTP response body in logs"},DEVICE_CANCEL_APDU_FLUSH_MECHANISM:{def:!0,parser:i,desc:"enable a mechanism that send a 0x00 apdu to force device to awake from its 'Processing' UI state"},DEVICE_PROXY_URL:{def:"",parser:a,desc:"enable a proxy to use instead of a physical device"},DEVICE_PROXY_MODEL:{def:"nanoS",parser:a,desc:"allow to override the default model of a proxied device"},DISABLE_TRANSACTION_BROADCAST:{def:!1,parser:i,desc:"disable broadcast of transactions"},DISABLE_SYNC_TOKEN:{def:!0,parser:i,desc:"disable a problematic mechanism of our API"},DISABLE_FW_UPDATE_VERSION_CHECK:{def:!1,parser:i,desc:"disable the version check for firmware update eligibility"},EIP1559_MINIMUM_FEES_GATE:{def:!0,parser:i,desc:"prevents the user from doing an EIP1559 transaction with fees too low"},EIP1559_PRIORITY_FEE_LOWER_GATE:{def:.85,parser:o,desc:"minimum priority fee percents allowed compared to network conditions allowed when EIP1559_MINIMUM_FEES_GATE is activated"},EIP1559_BASE_FEE_MULTIPLIER:{def:1.27,parser:o,desc:"mutiplier for the base fee that is composing the maxFeePerGas property"},EXPERIMENTAL_BLE:{def:!1,parser:i,desc:"enable experimental support of Bluetooth"},EXPERIMENTAL_CURRENCIES:{def:"",parser:a,desc:"enable experimental support of currencies (comma separated)"},EXPERIMENTAL_EXPLORERS:{def:!1,parser:i,desc:"enable experimental explorer APIs"},EXPERIMENTAL_LANGUAGES:{def:!1,parser:i,desc:"enable experimental languages"},EXPERIMENTAL_MANAGER:{def:!1,parser:i,desc:"enable an experimental version of Manager"},EXPERIMENTAL_ROI_CALCULATION:{def:!1,parser:i,desc:"enable an experimental version of the portfolio percentage calculation"},EXPERIMENTAL_SEND_MAX:{def:!1,parser:i,desc:"force enabling SEND MAX even if not yet stable"},EXPERIMENTAL_USB:{def:!1,parser:i,desc:"enable an experimental implementation of USB support"},EXPERIMENTAL_SWAP:{def:!1,parser:i,desc:"enable an experimental swap interface"},EXPLORER:{def:"https://explorers.api.live.ledger.com",parser:a,desc:"Ledger generic explorer API"},EXPLORER_STAGING:{def:"https://explorers.api-01.live.ledger-stg.com",parser:a,desc:"Ledger staging explorer API"},EXPLORER_BETA:{def:"https://explorers.api.live.ledger.com",parser:a,desc:"Ledger generic explorer beta API"},EXPLORER_SATSTACK:{def:"http://localhost:20000",parser:a,desc:"Ledger satstack Bitcoin explorer API"},EXPORT_EXCLUDED_LOG_TYPES:{def:"ble-frame",parser:a,desc:"comma-separated list of excluded log types for exported logs"},EXPORT_MAX_LOGS:{def:5e3,parser:s,desc:"maximum logs to keep for export"},DISABLE_APP_VERSION_REQUIREMENTS:{def:!1,parser:i,desc:"force an old application version to be accepted regardless of its version"},FORCE_PROVIDER:{def:1,parser:s,desc:"use a different provider for app store (for developers only)"},FILTER_ZERO_AMOUNT_ERC20_EVENTS:{def:!0,parser:i,desc:"Remove filter of address poisoning"},GET_CALLS_RETRY:{def:2,parser:s,desc:"how many times to retry a GET http call"},GET_CALLS_TIMEOUT:{def:6e4,parser:s,desc:"how much time to timeout a GET http call"},HIDE_EMPTY_TOKEN_ACCOUNTS:{def:!1,parser:i,desc:"hide the sub accounts when they are empty"},KEYCHAIN_OBSERVABLE_RANGE:{def:0,parser:s,desc:"overrides the gap limit specified by BIP44 (default to 20)"},LEDGER_CLIENT_VERSION:{def:"",parser:a,desc:"the 'X-Ledger-Client-Version' HTTP header to use for queries to Ledger APIs"},LEDGER_COUNTERVALUES_API:{def:"https://countervalues.live.ledger.com",parser:a,desc:"Ledger countervalues API"},LEDGER_REST_API_BASE:{def:"https://explorers.api.live.ledger.com",parser:a,desc:"DEPRECATED"},LEGACY_KT_SUPPORT_TO_YOUR_OWN_RISK:{def:!1,parser:i,desc:"enable sending to KT accounts. Not tested."},MANAGER_API_BASE:{def:"https://manager.api.live.ledger.com/api",parser:a,desc:"Ledger Manager API"},MANAGER_DEV_MODE:{def:!1,parser:i,desc:"enable visibility of utility apps in Manager"},MANAGER_INSTALL_DELAY:{def:1e3,parser:s,desc:"defines the time to wait before installing apps to prevent known glitch (<=1.5.5) when chaining installs"},MAPPING_SERVICE:{def:"https://mapping-service.api.ledger.com",parser:a,desc:""},MAX_ACCOUNT_NAME_SIZE:{def:50,parser:s,desc:"maximum size of account names"},MOCK:{def:"",parser:a,desc:"switch the app into a MOCK mode for test purpose, the value will be used as a seed for the rng. Avoid falsy values."},MOCK_COUNTERVALUES:{def:"",parser:a,desc:"switch the countervalues resolution into a MOCK mode for test purpose"},MOCK_APP_UPDATE:{def:!1,parser:i,desc:"Always shows app update in the manager"},MOCK_EXCHANGE_TEST_CONFIG:{def:!1,parser:i,desc:"mock the cryptoassets config and test partner (in the context of app-exchange)"},MOCK_REMOTE_LIVE_MANIFEST:{def:"",parser:a,desc:"mock remote live app manifest"},MOCK_OS_VERSION:{def:"",parser:a,desc:"if defined, overrides the os and version. format: os@version. Example: Windows_NT@6.1.7601"},MOCK_NO_BYPASS:{def:!1,parser:i,desc:"if defined, avoids bypass of the currentDevice in the store."},NFT_CURRENCIES:{def:["avalanche_c_chain","bsc","ethereum","polygon"],parser:l,desc:"set the currencies where NFT is active"},NFT_ETH_METADATA_SERVICE:{def:"https://nft.api.live.ledger.com",parser:a,desc:"service uri used to get the metadata of an nft"},OPERATION_ADDRESSES_LIMIT:{def:100,parser:s,desc:"limit the number of addresses in from/to of operations"},OPERATION_OPTIMISTIC_RETENTION:{def:18e5,parser:s,desc:"timeout to keep an optimistic operation that was broadcasted but not yet visible from the coin implementation or the API"},OPERATION_PAGE_SIZE_INITIAL:{def:100,parser:s,desc:"defines the initial default operation length page to use"},POLKADOT_ELECTION_STATUS_THRESHOLD:{def:25,parser:s,desc:"in blocks - number of blocks before Polkadot election effectively opens to consider it as open and disable all staking features"},SATSTACK:{def:!1,parser:i,desc:"Switch to satstack mode"},SCAN_FOR_INVALID_PATHS:{def:!1,parser:i,desc:"enable searching accounts in exotic derivation paths"},SEED:{def:"",parser:a,desc:"(dev feature) seed to be used by speculos (device simulator)"},SHOW_LEGACY_NEW_ACCOUNT:{def:!1,parser:i,desc:"allow the creation of legacy accounts"},SIMPLE_HASH_API_BASE:{def:"https://simplehash.api.live.ledger.com/api/v0",parser:a,desc:"SimpleHash API base url"},SKIP_ONBOARDING:{def:!1,parser:i,desc:"dev flag to skip onboarding flow"},SPECULOS_API_PORT:{def:0,parser:s,desc:"API port for speculos"},SPECULOS_PID_OFFSET:{def:0,parser:s,desc:"offset to be added to the speculos pid and avoid collision with other instances"},SPECULOS_USE_WEBSOCKET:{def:!1,parser:i,desc:"Use speculos websocket interface instead of Rest API"},SWAP_API_BASE:{def:"https://swap.ledger.com/v5",parser:a,desc:"Swap API base"},SWAP_USER_IP:{def:"",parser:a,desc:"Swap IP"},SWAP_DISABLE_APPS_INSTALL:{def:!1,parser:i,desc:"bypass app checks on Nano for speculos swap tests"},SYNC_ALL_INTERVAL:{def:48e4,parser:s,desc:"delay between successive sync"},SYNC_BOOT_DELAY:{def:2e3,parser:s,desc:"delay before the sync starts"},SYNC_PENDING_INTERVAL:{def:1e4,parser:s,desc:"delay between sync when an operation is still pending"},SYNC_OUTDATED_CONSIDERED_DELAY:{def:6e5,parser:s,desc:"delay until Live consider a sync outdated"},SYNC_MAX_CONCURRENT:{def:4,parser:s,desc:"maximum limit to synchronize accounts concurrently to limit overload"},BOT_MAX_CONCURRENT:{def:10,parser:s,desc:"maximum limit to run bot spec in parallel"},USER_ID:{def:"",parser:a,desc:"unique identifier of app instance. used to derivate dissociated ids for difference purposes (e.g. the firmware update incremental deployment)."},WALLETCONNECT:{def:!1,parser:i,desc:"is walletconnect enabled"},CLOUD_SYNC_API_STAGING:{def:"https://cloud-sync-backend.api.aws.stg.ldg-tech.com",parser:a,desc:"wallet sync api staging base url"},CLOUD_SYNC_API_PROD:{def:"https://cloud-sync.api.live.ledger.com",parser:a,desc:"wallet sync api production base url"},WITH_DEVICE_POLLING_DELAY:{def:500,parser:o,desc:"delay when polling device"},ANNOUNCEMENTS_API_URL:{def:"https://cdn.live.ledger.com/announcements",parser:a,desc:"url used to fetch new announcements"},ANNOUNCEMENTS_API_VERSION:{def:1,parser:s,desc:"version used for the announcements api"},STATUS_API_URL:{def:"https://ledger.statuspage.io/api",parser:a,desc:"url used to fetch ledger status"},STATUS_API_VERSION:{def:2,parser:s,desc:"version used for ledger status api"},TEZOS_MAX_TX_QUERIES:{def:100,parser:s,desc:"safe max on maximum number of queries to synchronize a tezos account"},TRUSTCHAIN_API_STAGING:{def:"https://trustchain-backend.api.aws.stg.ldg-tech.com",parser:a,desc:"Trustchain API Staging"},TRUSTCHAIN_API_PROD:{def:"https://trustchain.api.live.ledger.com",parser:a,desc:"Trustchain API Prod"},PLATFORM_DEBUG:{def:!1,parser:i,desc:"enable visibility of debug apps and tools in Platform Catalog"},PLATFORM_EXPERIMENTAL_APPS:{def:!1,parser:i,desc:"enable visibility of experimental apps and tools in Platform Catalog"},PLATFORM_MANIFEST_API_URL:{def:"https://live-app-catalog.ledger.com/api/v1/apps",parser:a,desc:"url used to fetch platform app manifests"},PLATFORM_LOCAL_MANIFEST_JSON:{def:"",parser:a,desc:'json manifest for a local (test) platform app manifests. How to use: PLATFORM_LOCAL_MANIFEST_JSON="$(cat /path/to/file.json)"'},PLATFORM_GLOBAL_CATALOG_API_URL:{def:"https://cdn.live.ledger.com/platform/catalog/v1/data.json",parser:a,desc:"url used to fetch platform app manifests"},PLATFORM_GLOBAL_CATALOG_STAGING_API_URL:{def:"https://cdn.live.ledger-stg.com/platform/catalog/v1/data.json",parser:a,desc:"url used to fetch platform app manifests (staging)"},PLATFORM_RAMP_CATALOG_API_URL:{def:"https://cdn.live.ledger.com/platform/trade/v1/data.json",parser:a,desc:"url used to fetch platform app manifests"},PLATFORM_RAMP_CATALOG_STAGING_API_URL:{def:"https://cdn.live.ledger-stg.com/platform/trade/v1/data.json",parser:a,desc:"url used to fetch platform app manifests (staging)"},PLATFORM_API_URL:{def:"",parser:a,desc:"url used to fetch platform catalog"},PLATFORM_API_VERSION:{def:1,parser:s,desc:"version used for the platform api"},PLAYWRIGHT_RUN:{def:!1,parser:i,desc:"true when launched for E2E testing"},MARKET_API_URL:{def:"https://proxycg.api.live.ledger.com/api/v3",parser:a,desc:"Market data api"},USE_LEARN_STAGING_URL:{def:!1,parser:i,desc:"use the staging URL for the learn page"},DYNAMIC_CAL_BASE_URL:{def:"https://cdn.live.ledger.com/cryptoassets",parser:a,desc:"bucket S3 of the dynamic cryptoassets list"},CAL_SERVICE_URL:{def:"https://crypto-assets-service.api.ledger.com",parser:a,desc:"Cryptoassets list service url"},FEATURE_FLAGS:{def:"{}",parser:e=>{try{if("string"!=typeof e)throw new Error;return JSON.parse(e)}catch(e){return undefined}},desc:"key value map for feature flags: {[key in FeatureId]?: Feature]}"},PERFORMANCE_CONSOLE:{def:!1,parser:i,desc:"Show a performance overlay on the app UI"},ETHEREUM_STUCK_TRANSACTION_TIMEOUT:{def:3e5,parser:s,desc:"Time after which an optimisc operation is considered stuck"},EVM_REPLACE_TX_LEGACY_GASPRICE_FACTOR:{def:1.3,parser:o,desc:"Replace transaction gasprice factor for legacy evm transaction. This value should be 1.1 minimum since this is the minimum increase required by most nodes"},EVM_REPLACE_TX_EIP1559_MAXFEE_FACTOR:{def:1.3,parser:o,desc:"Replace transaction max fee factor for EIP1559 evm transaction. This value should be 1.1 minimum since this is the minimum increase required by most nodes"},EVM_REPLACE_TX_EIP1559_MAXPRIORITYFEE_FACTOR:{def:1.1,parser:o,desc:"Replace transaction max priority fee factor for EIP1559 evm transaction. This value should be 1.1 minimum since this is the minimum increase required by most nodes"},EVM_FORCE_LEGACY_TRANSACTIONS:{def:!1,parser:i,desc:"Force transaction type 0 on EVM networks"},ENABLE_NETWORK_LOGS:{def:!1,parser:i,desc:"Enable network request and responses logs. Errors are always logged"},CRYPTO_ASSET_SEARCH_KEYS:{def:["ticker","name","keywords"],parser:l,desc:"Fuse search attributes to find a currency according to user input"},VERBOSE:{def:[],parser:l,desc:'Sets up debug console printing of logs. `VERBOSE=1` or `VERBOSE=true`: to print all logs | `VERBOSE="apdu,hw,transport,hid-verbose"` : filtering on a list of log `type` separated by a `,`'},DEFAULT_TRANSACTION_POLLING_INTERVAL:{def:3e4,parser:s,desc:"Default interval to poll for transaction confirmation in speedup/cancel evm flow (in ms)"},LOW_BATTERY_PERCENTAGE:{def:20,parser:s,desc:"Configure the low battery percentage threshold"},LOG_DRAWERS:{def:!1,parser:i,desc:"Enable logs for drawers"}};r.getDefinition=e=>e in c?c[e]:undefined;const d=Object.keys(c).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:c[t].def})),{}),u=Object.assign({},d);r.getAllEnvNames=()=>Object.keys(c);r.getAllEnvs=()=>Object.assign({},u);r.getEnv=e=>u[e];r.getEnvDefault=e=>d[e];r.isEnvDefault=e=>u[e]===d[e];r.getEnvDesc=e=>c[e].desc,r.changes=new n.Subject;r.setEnv=(e,t)=>{const n=u[e];n!==t&&(u[e]=t,r.changes.next({name:e,value:t,oldValue:n}))};r.setEnvUnsafe=(e,t)=>{const n=(0,r.getDefinition)(e);if(!n)return!1;const{parser:s}=n,o=s(t);return o===undefined||null===o?(console.warn(`Invalid ENV value for ${e}`),!1):((0,r.setEnv)(e,o),!0)}}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>@ledgerhq/evm-tools>@ledgerhq/live-env",file:"node_modules/@ledgerhq/live-env/lib/env.js"}],[925,{"./env":924},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){n===undefined&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){n===undefined&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),s(e("./env"),r)}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>@ledgerhq/evm-tools>@ledgerhq/live-env",file:"node_modules/@ledgerhq/live-env/lib/index.js"}],[926,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.listen=r.LocalTracer=r.trace=r.log=void 0;let n=0;const s=[];r.log=(e,t,r)=>{const s={type:e,id:String(++n),date:new Date};t&&(s.message=t),r&&(s.data=r),i(s)};r.trace=({type:e,message:t,data:r,context:s})=>{const o={type:e,id:String(++n),date:new Date};t&&(o.message=t),r&&(o.data=r),s&&(o.context=s),i(o)};class o{constructor(e,t){this.type=e,this.context=t}trace(e,t){(0,r.trace)({type:this.type,message:e,data:t,context:this.context})}getContext(){return this.context}setContext(e){this.context=e}updateContext(e){this.context=Object.assign(Object.assign({},this.context),e)}getType(){return this.type}setType(e){this.type=e}withType(e){return new o(e,this.context)}withContext(e){return new o(this.type,e)}withUpdatedContext(e){return new o(this.type,Object.assign(Object.assign({},this.context),e))}}r.LocalTracer=o;function i(e){for(let t=0;t<s.length;t++)try{s[t](e)}catch(e){console.error(e)}}r.listen=e=>(s.push(e),()=>{const t=s.indexOf(e);-1!==t&&(s[t]=s[s.length-1],s.pop())}),"undefined"!=typeof window&&(window.__ledgerLogsListen=r.listen)}}},{package:"@metamask/eth-ledger-bridge-keyring>@ledgerhq/hw-app-eth>@ledgerhq/logs",file:"node_modules/@ledgerhq/logs/lib/index.js"}],[93,{"../../../../shared/constants/metametrics":5662,"../../../../shared/lib/bridge-status/metrics":5689,"../../../../shared/lib/transactions-controller-utils":5706,"../../../../shared/modules/bridge-utils/bridge.util":5710,"../../../../shared/modules/bridge-utils/caip-formatters":5711,"../../../../shared/modules/conversion.utils":5717,"../../../../shared/types/bridge-status":5741,"./metrics-utils":92},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.handleTransactionFailedTypeBridge=r.handleBridgeTransactionFailed=r.handleBridgeTransactionComplete=void 0;var n=e("../../../../shared/modules/conversion.utils"),s=e("../../../../shared/lib/transactions-controller-utils"),o=e("../../../../shared/constants/metametrics"),i=e("../../../../shared/types/bridge-status"),a=e("../../../../shared/modules/bridge-utils/bridge.util"),l=e("../../../../shared/lib/bridge-status/metrics"),c=e("../../../../shared/modules/bridge-utils/caip-formatters"),d=e("./metrics-utils");r.handleBridgeTransactionComplete=async(e,{backgroundState:t,trackEvent:r})=>{var u;const{bridgeHistoryItem:f}=e,{hasApprovalTx:p,quote:h}=f,g={metamask:t},m=(0,l.getCommonProperties)(f,g),{chain_id_destination:E,usd_actual_gas:_,usd_quoted_return:T,usd_quoted_gas:A}=m,b=(null===(u=f.status.destChain)||void 0===u?void 0:u.amount)??"0",O=(0,s.calcTokenAmount)(b,f.quote.destAsset.decimals).toNumber(),w=await(0,d.getTokenUsdValue)({chainId:(0,c.formatChainIdToHex)(E),tokenAmount:O,tokenAddress:h.destAsset.address,state:g})??0,v=T&&w?T/w:0,I=A&&_?A/_:0,N=i.StatusTypes.COMPLETE,P=i.StatusTypes.COMPLETE,S=(0,a.isEthUsdt)((0,n.decimalToPrefixedHex)(h.srcChainId),h.srcAsset.address)&&p?{allowance_reset_transaction:i.StatusTypes.COMPLETE}:undefined,y=p?{approval_transaction:i.StatusTypes.COMPLETE}:undefined,C={...m,usd_actual_return:w,quote_vs_execution_ratio:v,quoted_vs_used_gas_ratio:I,...S,...y,source_transaction:N,destination_transaction:P};r({category:o.MetaMetricsEventCategory.CrossChainSwaps,event:o.MetaMetricsEventName.ActionCompleted,properties:C})};r.handleBridgeTransactionFailed=async(e,{backgroundState:t,trackEvent:r})=>{var s;const{bridgeHistoryItem:c}=e,{hasApprovalTx:d,quote:u,status:f}=c,p={metamask:t},h=(0,l.getCommonProperties)(c,p),g=f.srcChain.txHash?i.StatusTypes.COMPLETE:i.StatusTypes.FAILED,m=null!==(s=f.destChain)&&void 0!==s&&s.txHash?i.StatusTypes.COMPLETE:i.StatusTypes.FAILED,E={...h,allowance_reset_transaction:(0,a.isEthUsdt)((0,n.decimalToPrefixedHex)(u.srcChainId),u.srcAsset.address)&&d&&f.srcChain.txHash?i.StatusTypes.COMPLETE:i.StatusTypes.FAILED,approval_transaction:d&&f.srcChain.txHash?i.StatusTypes.COMPLETE:i.StatusTypes.FAILED,source_transaction:g,destination_transaction:m,error_message:""};r({category:o.MetaMetricsEventCategory.CrossChainSwaps,event:o.MetaMetricsEventName.ActionFailed,properties:E})};r.handleTransactionFailedTypeBridge=async(e,{backgroundState:t,trackEvent:r})=>{const s={metamask:t},{transactionMeta:c}=e,d=s.metamask.bridgeStatusState.txHistory[c.id],{quote:u,hasApprovalTx:f}=d,p=(0,l.getCommonProperties)(d,s),h=i.StatusTypes.FAILED,g={...p,...(0,a.isEthUsdt)((0,n.decimalToPrefixedHex)(u.srcChainId),u.srcAsset.address)&&f?{allowance_reset_transaction:i.StatusTypes.COMPLETE}:undefined,...f?{approval_transaction:i.StatusTypes.COMPLETE}:undefined,source_transaction:h,error_message:e.error};r({category:o.MetaMetricsEventCategory.CrossChainSwaps,event:o.MetaMetricsEventName.ActionFailed,properties:g})}}}},{package:"$root$",file:"app/scripts/lib/bridge-status/metrics.ts"}],[94,{"../../../shared/constants/time":5679,loglevel:4795,"readable-stream":5206},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.THREE_MINUTES=void 0,r.default=function(){const e=l();return new s.Transform({transform(t,r,n){const s=t.id===undefined,i=e.add(t.id);s||i?n(null,t):(o.default.debug(`RPC request with id "${t.id}" already seen.`),n())},objectMode:!0})};var n,s=e("readable-stream"),o=(n=e("loglevel"))&&n.__esModule?n:{default:n},i=e("../../../shared/constants/time");const a=r.THREE_MINUTES=3*i.MINUTE,l=()=>{const e=new Map;return setInterval((()=>{const t=Date.now()-a;for(const[r,n]of e.entries()){if(!(n<=t))break;e.delete(r)}}),a),{add:t=>!e.has(t)&&(e.set(t,Date.now()),!0)}}}}},{package:"$root$",file:"app/scripts/lib/createDupeReqFilterStream.ts"}],[95,{"../../../shared/constants/permissions":5670,"../controllers/permissions":63,"@metamask/keyring-api":1906},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({messenger:e}){return function(t,r,s,o){const a=e.call("AccountsController:getSelectedAccount");if((0,n.isEvmAccountType)(a.type))return s();if(i.includes(t.method))return o(new Error(`Non-EVM account cannot request this method: ${t.method}`));if("wallet_requestPermissions"===t.method&&null!=t&&t.params&&Array.isArray(t.params)&&t.params.length>0&&t.params[0]){const e=Object.keys(t.params[0]);if(i.some((t=>e.includes(t))))return o(new Error(`Non-EVM account cannot request this method: ${e.toString()}`))}return s()}};var n=e("@metamask/keyring-api"),s=e("../../../shared/constants/permissions"),o=e("../controllers/permissions");const i=[...Object.values(s.RestrictedEthMethods),...o.unrestrictedEthSigningMethods]}}},{package:"$root$",file:"app/scripts/lib/createEvmMethodsToNonEvmAccountReqFilterMiddleware.ts"}],[96,{loglevel:4795},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return function(t,r,n){n((n=>{r.error&&s.default.debug("Error in RPC response:\n",r),t.isMetamaskInternal||(s.default.info(`RPC (${e.origin}): ${t.method} -> ${r.error?"error":"success"}`),n())}))}};var n,s=(n=e("loglevel"))&&n.__esModule?n:{default:n}}}},{package:"$root$",file:"app/scripts/lib/createLoggerMiddleware.js"}],[97,{},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({mainFrameOrigin:e}){return function(t,r,n){t.mainFrameOrigin=e,n()}}}}},{package:"$root$",file:"app/scripts/lib/createMainFrameOriginMiddleware.ts"}],[98,{"./stream-utils":163,"@metamask/rpc-errors":2336},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("@metamask/rpc-errors"),s=e("./stream-utils");r.default=(e,t)=>async r=>{if(!(0,s.isStreamWritable)(t))return;if(!e[r.method])return void t.write({jsonrpc:"2.0",error:n.rpcErrors.methodNotFound({message:`${r.method} not found`}),id:r.id});let o,i;try{o=await e[r.method](...r.params)}catch(e){i=e}(0,s.isStreamWritable)(t)?i?t.write({jsonrpc:"2.0",error:(0,n.serializeError)(i,{shouldIncludeStack:!0}),id:r.id}):t.write({jsonrpc:"2.0",result:o,id:r.id}):i&&console.error(i)}}}},{package:"$root$",file:"app/scripts/lib/createMetaRPCHandler.js"}],[99,{"./middleware/pending":117,"@metamask/eth-json-rpc-middleware":1611,"@metamask/json-rpc-engine":1860},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function({version:e,getAccounts:t,processTransaction:r,processTypedMessage:i,processTypedMessageV3:a,processTypedMessageV4:l,processPersonalMessage:c,processDecryptMessage:d,processEncryptionPublicKey:u,getPendingNonce:f,getPendingTransactionByHash:p}){return(0,n.mergeMiddleware)([(0,n.createScaffoldMiddleware)({eth_syncing:!1,web3_clientVersion:`MetaMask/v${e}`}),(0,s.createWalletMiddleware)({getAccounts:t,processTransaction:r,processTypedMessage:i,processTypedMessageV3:a,processTypedMessageV4:l,processPersonalMessage:c,processDecryptMessage:d,processEncryptionPublicKey:u}),(0,o.createPendingNonceMiddleware)({getPendingNonce:f}),(0,o.createPendingTxMiddleware)({getPendingTransactionByHash:p})])};var n=e("@metamask/json-rpc-engine"),s=e("@metamask/eth-json-rpc-middleware"),o=e("./middleware/pending")}}},{package:"$root$",file:"app/scripts/lib/createMetamaskMiddleware.js"}],[4,{"../../shared/constants/app":5651,"../../shared/constants/metametrics":5662,"../../shared/constants/offscreen-communication":5668,"../../shared/modules/browser-runtime.utils":5714,"../../shared/modules/mv3.utils":5726,"../../shared/modules/object.utils":5728,"../../shared/modules/selectors/networks":5734,"../../test/e2e/background-socket/socket-background-to-mocha":5744,"../../test/e2e/default-fixture":5746,"../../test/stub/keyring-bridge":5752,"./constants/marketing-site-whitelist":6,"./constants/sentry-state":7,"./first-time-state":74,"./fixtures/generate-wallet-state":75,"./lib/createStreamSink":104,"./lib/ens-ipfs/setup":111,"./lib/get-first-preferred-lang-code":113,"./lib/getObjStructure":114,"./lib/migrator":118,"./lib/notification-manager":120,"./lib/setup-initial-state-hooks":148,"./lib/stores/extension-store":160,"./lib/stores/persistence-manager":161,"./lib/stores/read-only-network-store":162,"./lib/util":174,"./metamask-controller":175,"./migrations":344,"./offscreen":345,"./platforms/extension":346,"@metamask/notification-services-controller":2149,"@metamask/obs-store":2162,"@metamask/utils":2872,"debounce-stream":4091,events:4267,"extension-port-stream":4270,loglevel:4795,"readable-stream":5206,"webextension-polyfill":5628},function(){with(this.scopeTerminator)with(this.globalThis)return function(){"use strict";return function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.loadStateFromPersistence=Ae,r.setupController=ve,r.statePersistenceEvents=void 0,e("./lib/setup-initial-state-hooks");var n=F(e("events")),s=e("readable-stream"),o=F(e("debounce-stream")),i=F(e("loglevel")),a=F(e("webextension-polyfill")),l=e("@metamask/obs-store"),c=e("@metamask/utils"),d=F(e("extension-port-stream")),u=e("@metamask/notification-services-controller"),f=e("../../shared/constants/app"),p=e("../../shared/constants/metametrics"),h=e("../../shared/modules/browser-runtime.utils"),g=e("../../shared/modules/mv3.utils"),m=e("../../shared/modules/object.utils"),E=(e("../../test/e2e/default-fixture"),e("../../test/e2e/background-socket/socket-background-to-mocha"),e("../../shared/constants/offscreen-communication"),e("../../test/stub/keyring-bridge")),_=e("../../shared/modules/selectors/networks"),T=e("./lib/stores/persistence-manager"),A=F(e("./lib/stores/extension-store")),b=F(e("./lib/stores/read-only-network-store")),O=F(e("./migrations")),w=F(e("./lib/migrator")),v=F(e("./platforms/extension")),I=e("./constants/sentry-state"),N=F(e("./lib/createStreamSink")),P=U(e("./lib/notification-manager")),S=U(e("./metamask-controller")),y=F(e("./lib/get-first-preferred-lang-code")),C=F(e("./lib/getObjStructure")),R=F(e("./lib/ens-ipfs/setup")),M=e("./lib/util"),L=e("./offscreen"),k=(e("./fixtures/generate-wallet-state"),F(e("./first-time-state"))),x=e("./constants/marketing-site-whitelist");function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(D=function(e){return e?r:t})(e)}function U(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=D(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&{}.hasOwnProperty.call(e,o)){var i=s?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function F(e){return e&&e.__esModule?e:{default:e}}const B="#0376C9",j="#D73847",G=9,V=!1,q=new w.default({migrations:O.default,defaultVersion:null}),H=V?new b.default:new A.default,Y=new T.PersistenceManager({localStore:H});global.stateHooks.getMostRecentPersistedState=()=>Y.mostRecentRetrievedState;const{sentry:$}=global;let K={...k.default};const X={[f.ENVIRONMENT_TYPE_POPUP]:!0,[f.ENVIRONMENT_TYPE_NOTIFICATION]:!0,[f.ENVIRONMENT_TYPE_FULLSCREEN]:!0},z=["trezor-connect"];i.default.setLevel("info",!1);const W=new v.default,Z=new P.default,J=(0,M.getPlatform)()===f.PLATFORM_FIREFOX;let Q=0,ee=!1,te=!1;const re={},ne={};let se;const oe={};V&&(global.stateHooks.metamaskGetState=Y.get.bind(Y));const ie=new URL("https://metamask.github.io/phishing-warning/v4.1.0/"),ae=ie.toString(),le=1e3,ce=r.statePersistenceEvents=new n.default;J?a.default.runtime.onInstalled.addListener((function(e){"install"===e.reason?a.default.storage.session.set({isFirstTimeInstall:!0}):"update"===e.reason&&a.default.storage.session.set({isFirstTimeInstall:!1})})):g.isManifestV3||a.default.runtime.onInstalled.addListener((function(e){"install"===e.reason?global.sessionStorage.setItem("isFirstTimeInstall",!0):"update"===e.reason&&global.sessionStorage.setItem("isFirstTimeInstall",!1)}));const{promise:de,resolve:ue,reject:fe}=(0,M.deferredPromise)(),pe=async()=>{const e=await a.default.tabs.query({url:"<all_urls>",windowType:"normal"}).then((e=>((0,h.checkForLastErrorAndLog)(),e))).catch((()=>{(0,h.checkForLastErrorAndLog)()}));for(const t of e)a.default.tabs.sendMessage(t.id,{name:f.EXTENSION_MESSAGES.READY}).then((()=>{(0,h.checkForLastErrorAndLog)()})).catch((()=>{(0,h.checkForLastErrorAndLog)()}))};let he,ge,me;function Ee(){const e=(new Date).toISOString();a.default.storage.session.set({timestamp:e})}async function _e(){try{const t=g.isManifestV3?(0,L.createOffscreen)():null,r=await Ae(),n=r.data,s=await(0,y.default)();let o;if(g.isManifestV3){var e;if(!1!==(null===(e=n.PreferencesController)||void 0===e?void 0:e.enableMV3TimestampSave)){const e=2e3;Ee(),setInterval(Ee,e)}const t=await a.default.storage.session.get(["isFirstMetaMaskControllerSetup"]);o=(null==t?void 0:t.isFirstMetaMaskControllerSetup)===undefined,await a.default.storage.session.set({isFirstMetaMaskControllerSetup:o})}ve(n,s,V?{keyrings:{trezorBridge:E.FakeTrezorBridge,ledgerBridge:E.FakeLedgerBridge}}:{},o,r.meta,t),function(e){async function t(e,t){try{return await a.default.tabs.update(e,{url:t})}catch(e){return null==$?void 0:$.captureException(e)}}const r=!g.isManifestV3;a.default.webRequest.onBeforeRequest.addListener((n=>{var s,o,i;if(n.tabId===a.default.tabs.TAB_ID_NONE)return{};const{completedOnboarding:l}=e.onboardingController.state;if(!l)return{};if(!e.preferencesController.state.usePhishDetect)return{};if(n.initiator&&new URL(n.initiator).host===ie.host)return{};const{hostname:c,href:d,searchParams:u}=new URL(n.url);if(V&&u.has("IN_TEST_BYPASS_EARLY_PHISHING_DETECTION"))return{};e.phishingController.maybeUpdateState();const f=e.phishingController.isBlockedRequest(n.url);let h,g;if("main_frame"!==n.type&&"sub_frame"!==n.type||(h=e.phishingController.test(n.url)),!(null!==(s=h)&&void 0!==s&&s.result||f.result))return{};let m=c;null!==(o=h)&&void 0!==o&&o.result&&f.result?g=`${h.type} and ${f.type}`:null!==(i=h)&&void 0!==i&&i.result?g=h.type:(g=f.type,m=n.initiator),e.metaMetricsController.trackEvent({event:p.MetaMetricsEventName.PhishingPageDisplayed,category:p.MetaMetricsEventCategory.Phishing,properties:{url:m,referrer:{url:m},reason:g,requestDomain:f.result?c:undefined}});const E=new URLSearchParams({hostname:c,href:d}),_=new URL(ae);_.hash=E.toString();const T=_.toString();return r?"main_frame"===n.type?{redirectUrl:T}:(t(n.tabId,T),{cancel:!0}):(t(n.tabId,T),{})}),{urls:["http://*/*","https://*/*","ws://*/*","wss://*/*"]},r?["blocking"]:[])}(se),g.isManifestV3||await async function(){let e;try{const t=new URL(ae);let r,n;t.hash="#extensionStartup",e=window.document.createElement("iframe"),e.setAttribute("src",t.href),e.setAttribute("sandbox","allow-scripts allow-same-origin");const s=new Promise(((e,t)=>{r=e,n=t}));e.addEventListener("load",r),window.document.body.appendChild(e),setTimeout((()=>n(new Te)),le),await s}catch(e){e instanceof Te?console.warn("Phishing warning page timeout; page not guaranteed to work offline."):console.error("Failed to initialize phishing warning page",e)}finally{e&&e.remove()}}(),await pe(),i.default.info("MetaMask initialization complete."),g.isManifestV3||J?a.default.storage.session.set({isFirstTimeInstall:!1}):global.sessionStorage.setItem("isFirstTimeInstall",!1),ue()}catch(e){fe(e)}}a.default.runtime.onConnect.addListener((async(...e)=>{await de,he(...e)})),a.default.runtime.onConnectExternal.addListener((async(...e)=>{var t;await de;null!==(t=e[0].sender.tab)&&void 0!==t&&t.id,ge(...e)}));class Te extends Error{constructor(){super("Timeout failed")}}async function Ae(){q.on("error",console.warn);const e=await Y.get()||q.generateInitialState(K);q.on("error",(t=>{const r=(0,C.default)(e);$.captureException(t,{extra:{vaultStructure:r}})}));const t=await q.migrateData(e);if(!t)throw new Error("MetaMask - migrator returned undefined");if(!(0,c.isObject)(t.meta))throw new Error(`MetaMask - migrator metadata has invalid type '${typeof t.meta}'`);if("number"!=typeof t.meta.version)throw new Error(`MetaMask - migrator metadata version has invalid type '${typeof t.meta.version}'`);if(!(0,c.isObject)(t.data))throw new Error(`MetaMask - migrator data has invalid type '${typeof t.data}'`);return Y.setMetadata(t.meta),Y.set(t.data),t}function be(e){const{metaMetricsId:t}=se.metaMetricsController.state;if(!(0,M.shouldEmitDappViewedEvent)(t))return;const r=se.getPermittedAccounts(e).length;if(0===r)return;const n=se.controllerMessenger.call("PreferencesController:getState"),s=Object.keys(n.identities).length;se.metaMetricsController.trackEvent({event:p.MetaMetricsEventName.DappViewed,category:p.MetaMetricsEventCategory.InpageProvider,referrer:{url:e},properties:{is_first_visit:!1,number_of_accounts:s,number_of_accounts_connected:r}})}function Oe(e){if(!e.sender||!e.sender.tab||!e.sender.url)return;const t=e.sender.tab.id,r=new URL(e.sender.url),{origin:n}=r;Object.keys(oe).includes(t)||(oe[t]=n);const s=se.controllerMessenger.call("PermissionController:hasPermissions",n),o="New Tab"!==e.sender.tab.title;s&&o&&be(n)}function we(e){const t=[f.ENVIRONMENT_TYPE_POPUP,f.ENVIRONMENT_TYPE_NOTIFICATION,f.ENVIRONMENT_TYPE_FULLSCREEN];!(Object.values(re).some(Boolean)||ee||Q>0)&&t.includes(e)&&function(){const{metaMetricsId:e,participateInMetaMetrics:t}=se.metaMetricsController.state;(null!==e||t)&&se.metaMetricsController.trackEvent({event:p.MetaMetricsEventName.AppOpened,category:p.MetaMetricsEventCategory.App})}()}function ve(e,t,r,n,c,h){var E;se=new S.default({infuraProjectId:"b6bf7d3508c941499b10025c0776eaf8",showUserConfirmation:Ie,initState:e,initLangCode:t,platform:W,notificationManager:Z,browser:a.default,getRequestAccountTabIds:()=>ne,getOpenMetamaskTabsIds:()=>re,persistenceManager:Y,overrides:r,isFirstMetaMaskControllerSetup:n,currentMigrationVersion:c.version,featureFlags:{},offscreenPromise:h}),(0,R.default)({getCurrentChainId:()=>(0,_.getCurrentChainId)({metamask:se.networkController.state}),getIpfsGateway:se.preferencesController.getIpfsGateway.bind(se.preferencesController),getUseAddressBarEnsResolution:()=>se.preferencesController.state.useAddressBarEnsResolution,provider:se.provider}),(0,s.pipeline)((0,l.storeAsStream)(se.store),(0,o.default)(1e3),(0,N.default)((async e=>{await Y.set(e),ce.emit("state-persisted",e)})),(e=>{i.default.error("MetaMask - Persistence pipeline failed",e)})),E=se,global.stateHooks.getSentryAppState=function(){const e=E.memStore.getState();return(0,m.maskObject)(e,I.SENTRY_BACKGROUND_STATE)};const T=()=>Q>0||Boolean(Object.keys(re).length)||ee,A=(e,t)=>{if(!1===e)se.onClientClosed();else{if(t===f.ENVIRONMENT_TYPE_FULLSCREEN&&Boolean(Object.keys(re).length))return;se.onEnvironmentTypeClosed(t)}};function b(e,t){return e>t?`${t}+`:String(e)}function O(){const e=w(),t=function(){try{const{isNotificationServicesEnabled:e,isFeatureAnnouncementsEnabled:t}=se.notificationServicesController.state,r=Object.values(se.notificationServicesController.state.metamaskNotificationsList).filter((e=>e.type===u.NotificationServicesController.Constants.TRIGGER_TYPES.SNAP&&null===e.readDate)).length,n=t?se.notificationServicesController.state.metamaskNotificationsList.filter((e=>!e.isRead&&e.type===u.NotificationServicesController.Constants.TRIGGER_TYPES.FEATURES_ANNOUNCEMENT)).length:0,s=e?se.notificationServicesController.state.metamaskNotificationsList.filter((e=>!e.isRead&&e.type!==u.NotificationServicesController.Constants.TRIGGER_TYPES.FEATURES_ANNOUNCEMENT&&e.type!==u.NotificationServicesController.Constants.TRIGGER_TYPES.SNAP)).length:0;return r+n+s}catch(e){return console.error("Failed to get unread notifications count:",e),0}}();let r="",n=B;e?r=b(e,G):t>0&&(r=b(t,G),n=j);try{const e={text:r},t={color:n};g.isManifestV3?(a.default.action.setBadgeText(e),a.default.action.setBadgeBackgroundColor(t)):(a.default.browserAction.setBadgeText(e),a.default.browserAction.setBadgeBackgroundColor(t))}catch(e){console.error("Error updating browser badge:",e)}}function w(){try{let e=se.appStateController.waitingForUnlock.length+se.approvalController.getTotalApprovalCount();return e+=se.queuedRequestController.state.queuedRequestCount,e}catch(e){return console.error("Failed to get pending approval count:",e),0}}he=async e=>{var t;const n=e.name;if(z.includes(e.name))return;let o=!1;const l=null!==(t=e.sender)&&void 0!==t&&t.url?new URL(e.sender.url):null;if(o=J?X[n]:(null==l?void 0:l.origin)===`chrome-extension://${a.default.runtime.id}`,o){var c;const t=(null==r||null===(c=r.getPortStream)||void 0===c?void 0:c.call(r,e))||new d.default(e);if(se.isClientOpen=!0,se.setupTrustedCommunication(t,e.sender),we(n),async function(){try{await se.remoteFeatureFlagController.updateRemoteFeatureFlags()}catch(e){i.default.error("Error initializing remote feature flags:",e)}}(),n===f.ENVIRONMENT_TYPE_POPUP&&(Q+=1,(0,s.finished)(t,(()=>{Q-=1;const e=T();se.isClientOpen=e,A(e,f.ENVIRONMENT_TYPE_POPUP)}))),n===f.ENVIRONMENT_TYPE_NOTIFICATION&&(ee=!0,(0,s.finished)(t,(()=>{ee=!1;const e=T();se.isClientOpen=e,A(e,f.ENVIRONMENT_TYPE_NOTIFICATION)}))),n===f.ENVIRONMENT_TYPE_FULLSCREEN){const r=e.sender.tab.id;re[r]=!0,(0,s.finished)(t,(()=>{delete re[r];const e=T();se.isClientOpen=e,A(e,f.ENVIRONMENT_TYPE_FULLSCREEN)}))}}else if(l&&l.origin===ie.origin&&l.pathname===ie.pathname){var u;const t=(null==r||null===(u=r.getPortStream)||void 0===u?void 0:u.call(r,e))||new d.default(e);se.setupPhishingCommunication({connectionStream:t})}else{if(e.sender&&e.sender.tab&&e.sender.url){const t=e.sender.tab.id,r=new URL(e.sender.url),{origin:n}=r;Oe(e),e.onMessage.addListener((e=>{e.data&&e.data.method===f.MESSAGE_TYPE.ETH_REQUEST_ACCOUNTS&&(ne[n]=t)}))}if(l&&x.COOKIE_ID_MARKETING_WHITELIST_ORIGINS.some((e=>e===l.origin))){var p;const t=(null==r||null===(p=r.getPortStream)||void 0===p?void 0:p.call(r,e))||new d.default(e);se.setUpCookieHandlerCommunication({connectionStream:t})}ge(e)}},ge=e=>{var t;const n=(null==r||null===(t=r.getPortStream)||void 0===t?void 0:t.call(r,e))||new d.default(e);se.setupUntrustedCommunicationEip1193({connectionStream:n,sender:e.sender})},me=async e=>{var t;if(z.includes(e.name))return;e.sender&&e.sender.tab&&e.sender.url&&Oe(e);const n=(null==r||null===(t=r.getPortStream)||void 0===t?void 0:t.call(r,e))||new d.default(e);se.setupUntrustedCommunicationCaip({connectionStream:n,sender:e.sender})},null!=r&&r.registerConnectListeners&&r.registerConnectListeners(he,ge),O(),se.controllerMessenger.subscribe(S.METAMASK_CONTROLLER_EVENTS.DECRYPT_MESSAGE_MANAGER_UPDATE_BADGE,O),se.controllerMessenger.subscribe(S.METAMASK_CONTROLLER_EVENTS.ENCRYPTION_PUBLIC_KEY_MANAGER_UPDATE_BADGE,O),se.signatureController.hub.on(S.METAMASK_CONTROLLER_EVENTS.UPDATE_BADGE,O),se.controllerMessenger.subscribe(S.METAMASK_CONTROLLER_EVENTS.APP_STATE_UNLOCK_CHANGE,O),se.controllerMessenger.subscribe(S.METAMASK_CONTROLLER_EVENTS.APPROVAL_STATE_CHANGE,O),se.controllerMessenger.subscribe(S.METAMASK_CONTROLLER_EVENTS.QUEUED_REQUEST_STATE_CHANGE,O),se.controllerMessenger.subscribe(S.METAMASK_CONTROLLER_EVENTS.METAMASK_NOTIFICATIONS_LIST_UPDATED,O),se.controllerMessenger.subscribe(S.METAMASK_CONTROLLER_EVENTS.METAMASK_NOTIFICATIONS_MARK_AS_READ,O),Z.on(P.NOTIFICATION_MANAGER_EVENTS.POPUP_CLOSED,(({automaticallyClosed:e})=>{e?w()>0&&Ie():(se.signatureController.rejectUnapproved(p.REJECT_NOTIFICATION_CLOSE_SIG),se.decryptMessageController.rejectUnapproved(p.REJECT_NOTIFICATION_CLOSE),se.encryptionPublicKeyController.rejectUnapproved(p.REJECT_NOTIFICATION_CLOSE),se.rejectAllPendingApprovals()),O()})),Object.values(se.snapController.state.snaps).some((e=>!e.preinstalled))&&se.snapController.updateBlockedSnaps()}async function Ie(){const e=await W.getActiveTabs(),t=Boolean(e.find((e=>re[e.id]))),r=e.length>0&&e[0].extData&&e[0].extData.indexOf("vivaldi_tab")>-1;if(!te&&(r||0===Q)&&!t){te=!0;try{const e=se.appStateController.getCurrentPopupId();await Z.showPopup((e=>se.appStateController.setCurrentPopupId(e)),e)}finally{te=!1}}}const Ne=()=>{if(se)return se.metaMetricsController.updateTraits({[p.MetaMetricsUserTrait.InstallDateExt]:(new Date).toISOString().split("T")[0]}),void se.metaMetricsController.addEventBeforeMetricsOptIn({category:p.MetaMetricsEventCategory.App,event:p.MetaMetricsEventName.AppInstalled,properties:{}});setTimeout((()=>{Ne()}),500)};async function Pe(){const e=g.isManifestV3||J?await a.default.storage.session.get(["isFirstTimeInstall"]):await global.sessionStorage.getItem("isFirstTimeInstall");(null==e?void 0:e.isFirstTimeInstall)||(Ne(),W.openExtensionInBrowser()),a.default.tabs.onActivated.addListener((e=>{if(se){const{tabId:t}=e,r=oe[t];r&&se.permissionController.state.subjects[r]!==undefined&&be(r)}}))}(async function(){await Pe();try{await _e(),Y.cleanUpMostRecentRetrievedState()}catch(e){i.default.error(e)}})()}}},{package:"$root$",file:"app/scripts/background.js"}]],[4],{});